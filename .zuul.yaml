- project:
    templates:
      - check-requirements
      - openstack-lower-constraints-jobs
      - openstack-python-jobs-horizon
      - openstack-python35-jobs-horizon
      - openstack-python36-jobs-horizon
      - openstack-python37-jobs-horizon
      - release-notes-jobs-python3
    check:
      jobs:
        - sahara-dashboard-tox-python3-django111
    experimental:
      jobs:
        - sahara-dashboard-integration

- job:
    name: sahara-dashboard-tox-base
    parent: openstack-tox
    required-projects:
      - openstack/sahara-dashboard
    irrelevant-files:
      - ^.*\.rst$
      - ^doc/.*$
      - ^releasenotes/.*$
      - ^sahara_dashboard/locale/.*$

- job:
    name: sahara-dashboard-tox-python3-django111
    parent: sahara-dashboard-tox-base
    vars:
      tox_envlist: py3-dj111

- job:
    name: sahara-dashboard-integration
    parent: devstack
    required-projects:
      - openstack/heat
      - openstack/horizon
      - openstack/sahara
      - openstack/sahara-plugin-ambari
      - openstack/sahara-plugin-cdh
      - openstack/sahara-plugin-mapr
      - openstack/sahara-plugin-spark
      - openstack/sahara-plugin-storm
      - openstack/sahara-plugin-vanilla
      - openstack/sahara-dashboard
    roles:
      - zuul: openstack/horizon
    vars:
      devstack_plugins:
        sahara: 'git://git.openstack.org/openstack/sahara'
        sahara-dashboard: 'git://git.openstack.org/openstack/sahara-dashboard'
        heat: 'git://git.openstack.org/openstack/heat'
      devstack_services:
        horizon: true
        tls-proxy: false
    pre-run: playbooks/sahara-dashboard-integration/pre.yaml
    run: playbooks/sahara-dashboard-integration/run.yaml
    irrelevant-files:
      - ^.*\.rst$
      - ^doc/.*$
      - ^releasenotes/.*$
